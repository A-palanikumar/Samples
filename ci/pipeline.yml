resources:

  - name: cfg-cloudfoundry-src
    type: git
    source:
      uri: https://github.com/SteeltoeOSS/Samples
      branch: dev
      path: Configuration/src/AspDotNetCore/CloudFoundry

  - name: cfg-simple-src
    type: git
    source:
      uri: https://github.com/SteeltoeOSS/Samples
      branch: dev
      path: Configuration/src/AspDotNetCore/Simple

  - name: cfg-simplecloudfoundry-src
    type: git
    source:
      uri: https://github.com/SteeltoeOSS/Samples
      branch: dev
      path: Configuration/src/AspDotNetCore/SimpleCloudFoundry

jobs:

  - name: cfg-cloudfoundry
    plan:
      - get: Samples
        resource: cfg-cloudfoundry-src
        trigger: true
      - task: behave
        file: Samples/ci/tasks/behave.yml
        params:
          FEATURES: Configuration/src/AspDotNetCore/CloudFoundry
          CF_APIURL: {{cf_apiurl}}
          CF_USERNAME: {{cf_username}}
          CF_PASSWORD: {{cf_password}}
          CF_ORG: {{cf_org}}
        on_failure:
          task: behavelog
          file: Samples/ci/tasks/showlog.yml

  - name: cfg-simple
    plan:
      - get: Samples
        resource: cfg-simple-src
        trigger: true
      - task: behave
        file: Samples/ci/tasks/behave.yml
        params:
          FEATURES: Configuration/src/AspDotNetCore/Simple
        on_failure:
          task: behavelog
          file: Samples/ci/tasks/showlog.yml

  - name: cfg-simplecloudfoundry
    plan:
      - get: Samples
        resource: cfg-simplecloudfoundry-src
        trigger: true
      - task: behave
        file: Samples/ci/tasks/behave.yml
        params:
          FEATURES: Configuration/src/AspDotNetCore/SimpleCloudFoundry
          CF_APIURL: {{cf_apiurl}}
          CF_USERNAME: {{cf_username}}
          CF_PASSWORD: {{cf_password}}
          CF_ORG: {{cf_org}}
        on_failure:
          task: behavelog
          file: Samples/ci/tasks/showlog.yml
